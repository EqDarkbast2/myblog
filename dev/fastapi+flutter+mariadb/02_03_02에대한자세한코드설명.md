ë¬¼ë¡ ì´ì£ !  
ì•„ë˜ëŠ” ë§ì”€í•˜ì‹  Nginx ì„¤ì • ë¸”ë¡ í•˜ë‚˜í•˜ë‚˜ë¥¼ **ì´ˆë³´ìë„ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡** ì„¤ëª…í•œ ê²ƒì…ë‹ˆë‹¤.  
ì´ ì„¤ì •ì€ Flutter Web ì •ì  ì‚¬ì´íŠ¸ì™€ FastAPI ë°±ì—”ë“œ(API)ë¥¼ ë™ì‹œì— ì„œë¹„ìŠ¤í•˜ê¸° ìœ„í•œ **ëŒ€í‘œì ì¸ êµ¬ì„±**ì…ë‹ˆë‹¤.

---

## ğŸ”§ ì „ì²´ êµ¬ì¡° ìš”ì•½

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        # Flutter ì›¹ ë¹Œë“œ ê²°ê³¼ë¬¼ì„ ì„œë¹„ìŠ¤
    }

    location /api/ {
        # FastAPI ì„œë²„ë¡œ ìš”ì²­ì„ í”„ë¡ì‹œ (ì¤‘ê³„)
    }
}
```

---

## ğŸ“˜ ì¤„ë³„ ì„¤ëª…

### ```nginx
listen 80;
```
- ì›¹ì„œë²„ê°€ **HTTP í¬íŠ¸ 80**ì„ ì‚¬ìš©í•˜ë„ë¡ ì§€ì •í•©ë‹ˆë‹¤.
- HTTPSë¥¼ ì“¸ ê²½ìš° `listen 443 ssl;`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.

---

### ```nginx
server_name yourdomain.com;
```
- ì´ ì„¤ì •ì€ **ì–´ë–¤ ë„ë©”ì¸ìœ¼ë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ ì´ ì„¤ì •ì— ì—°ê²°í• ì§€**ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´: `server_name mymusicapp.com;`

---

### ```nginx
location / {
    root /var/www/my_project/frontend/build/web;
    index index.html;
    try_files $uri $uri/ /index.html;
}
```

#### ì„¤ëª…:

#### `location / { ... }`  
- ì›¹ì‚¬ì´íŠ¸ì˜ **ê¸°ë³¸ ì£¼ì†Œ** (`/`)ë¡œ ì ‘ê·¼í•  ë•Œ ì²˜ë¦¬ ë°©ì‹ì…ë‹ˆë‹¤.
- ì¦‰, `http://yourdomain.com/` ìœ¼ë¡œ ì ‘ì†í•  ë•Œ ì´ ë¸”ë¡ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.

#### `root /var/www/my_project/frontend/build/web;`
- ì •ì  íŒŒì¼ì„ ì„œë¹„ìŠ¤í•  **í´ë” ìœ„ì¹˜**ì…ë‹ˆë‹¤.  
  `flutter build web` ê²°ê³¼ê°€ ì €ì¥ëœ ê²½ë¡œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

#### `index index.html;`
- ì‚¬ìš©ìê°€ `/`ë¡œ ì ‘ì†í•˜ë©´ ìë™ìœ¼ë¡œ `index.html`ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

#### `try_files $uri $uri/ /index.html;`
- Angular, React, Flutter Webì²˜ëŸ¼ **SPA(Single Page Application)** êµ¬ì¡°ì—ì„œëŠ”  
  ë¼ìš°íŒ…ì„ ëª¨ë‘ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì—
  - ìš”ì²­í•œ íŒŒì¼ì´ ì—†ìœ¼ë©´ (`$uri`)
  - `index.html`ì„ ê¸°ë³¸ìœ¼ë¡œ ë³´ì—¬ì£¼ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.
  
ì˜ˆì‹œ:  
- `/music` ë˜ëŠ” `/playlist` ë¼ìš°íŠ¸ë¡œ ì ‘ì†í–ˆì„ ë•Œë„ `index.html`ì„ ë³´ì—¬ì£¼ê³ ,  
  Flutterê°€ ê·¸ì— ë§ëŠ” í˜ì´ì§€ë¡œ ë¼ìš°íŒ…í•©ë‹ˆë‹¤.

---

### ```nginx
location /api/ {
    proxy_pass http://127.0.0.1:8000/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```

#### ì„¤ëª…:

#### `location /api/`
- `/api/`ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ìš”ì²­ì€ ë°±ì—”ë“œ FastAPI ì„œë²„ë¡œ **í”„ë¡ì‹œ** ì²˜ë¦¬í•©ë‹ˆë‹¤.

ì˜ˆ:  
- `GET /api/music/search` â†’ FastAPI ì„œë²„ì˜ `/music/search` í˜¸ì¶œ

#### `proxy_pass http://127.0.0.1:8000/;`
- ìš”ì²­ì„ **ë¡œì»¬ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ FastAPI ì„œë²„ë¡œ ì „ë‹¬**í•©ë‹ˆë‹¤.
- ì—¬ê¸°ì„œ FastAPIëŠ” `127.0.0.1:8000`ì—ì„œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

#### `proxy_set_header Host $host;`
- í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ **Host í—¤ë”**ë¥¼ FastAPIì—ê²Œ ê·¸ëŒ€ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.

#### `proxy_set_header X-Real-IP $remote_addr;`
- í´ë¼ì´ì–¸íŠ¸ì˜ **ì‹¤ì œ IP ì£¼ì†Œ**ë¥¼ FastAPIì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.
- ë¡œê·¸ ë¶„ì„, ì‚¬ìš©ì ì¶”ì  ì‹œ ìœ ìš©í•©ë‹ˆë‹¤.

---

## ğŸ“Œ ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤

1. ì‚¬ìš©ìê°€ `http://yourdomain.com/` ì ‘ì† â†’ Flutter Web ì •ì  í˜ì´ì§€ ë³´ì—¬ì¤Œ
2. í˜ì´ì§€ ë‚´ì—ì„œ ìŒì•… ê²€ìƒ‰ ì‹œ `GET /api/music/search?query=OST` í˜¸ì¶œ
3. Nginxê°€ `/api/`ë¡œ ì‹œì‘í•˜ë¯€ë¡œ FastAPI ì„œë²„ë¡œ í•´ë‹¹ ìš”ì²­ í”„ë¡ì‹œ
4. FastAPIê°€ ì²˜ë¦¬ í›„ JSON ì‘ë‹µ ë°˜í™˜ â†’ Flutter Webì—ì„œ ì¬ìƒ ë“± ì²˜ë¦¬

---

## ğŸ”’ HTTPS ì„¤ì •í•˜ë ¤ë©´?

Let's Encrypt + Certbot ì‚¬ìš© ì‹œ:

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    location / {
        ...
    }

    location /api/ {
        ...
    }
}
```

---

ì´í•´ê°€ ì˜ ë˜ì…¨ì„ê¹Œìš”?  
ë” ë‚˜ì•„ê°€ì„œ `nginx.conf`ë¥¼ **ìë™ ìƒì„±í•´ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸**, **Flutter & FastAPI í”„ë¡ì‹œ ê²½ë¡œ ìë™ ì„¤ì •**ë„ ë„ì™€ë“œë¦´ ìˆ˜ ìˆì–´ìš”.  
í•„ìš”í•˜ë©´ ë§ì”€ë§Œ ì£¼ì„¸ìš”! ğŸ˜
