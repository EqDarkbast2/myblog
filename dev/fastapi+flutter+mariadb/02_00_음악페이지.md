ì¢‹ì•„ìš”! ë§ì”€í•˜ì‹  ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´ Flutter Web + FastAPIë¥¼ í™œìš©í•´ **ìŒì•… í˜ì´ì§€ ë° í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê¸°ëŠ¥**ì„ ë§Œë“¤ê³  ì‹¶ìœ¼ì‹  ê±°ê³ , ìŒì•… ì¬ìƒê¹Œì§€ ê°€ëŠ¥í• ì§€ë¥¼ í™•ì¸í•˜ê³  ì‹¶ìœ¼ì‹  ê±°ë„¤ìš”.  

---

## âœ… 1. êµ¬í˜„í•  ê¸°ëŠ¥ ì •ë¦¬

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ğŸµ ìŒì•… ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ/ê²€ìƒ‰ | ìŒì•… ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥ |
| â–¶ï¸ ìŒì•… ì¬ìƒ | ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ì¬ìƒ ë²„íŠ¼ í´ë¦­ ì‹œ ì˜¤ë””ì˜¤ ì¬ìƒ |
| ğŸ“‹ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê¸°ëŠ¥ | - ì¶”ê°€<br>- ì‚­ì œ<br>- ì €ì¥ëœ ë¦¬ìŠ¤íŠ¸ ì¬ìƒ |

---

## âœ… 2. **Flutter Webì—ì„œ ìŒì•… ì¬ìƒ ê°€ëŠ¥?**

**ê°€ëŠ¥í•©ë‹ˆë‹¤!**

- `<audio>` íƒœê·¸ëŠ” Flutter Webì—ì„œ ì§€ì›ë©ë‹ˆë‹¤.
- `audioplayers` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ì˜¤ë””ì˜¤ ì¬ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```yaml
# pubspec.yaml
dependencies:
  audioplayers: ^5.2.0
```

---

## âœ… 3. í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡° ì˜ˆì‹œ (Flutter Web)

### ìŒì•… ê²€ìƒ‰ + ì¬ìƒ UI

```dart
import 'package:audioplayers/audioplayers.dart';

final player = AudioPlayer();
List<Music> searchResults = []; // ì„œë²„ì—ì„œ ë°›ì€ ìŒì•… ë¦¬ìŠ¤íŠ¸

TextField(
  onChanged: (text) {
    // ê²€ìƒ‰ API í˜¸ì¶œ
  },
),

ListView.builder(
  itemCount: searchResults.length,
  itemBuilder: (context, index) {
    final music = searchResults[index];
    return ListTile(
      title: Text(music.title),
      trailing: IconButton(
        icon: Icon(Icons.play_arrow),
        onPressed: () {
          player.play(UrlSource(music.url)); // ìŒì•… URL
        },
      ),
      onTap: () {
        // í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
      },
    );
  },
);
```

---

## âœ… 4. ë°±ì—”ë“œ êµ¬ì¡° (FastAPI)

### í…Œì´ë¸” êµ¬ì¡°

```sql
CREATE TABLE music (
  id INT AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(255),
  url TEXT
);

CREATE TABLE playlists (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT,
  name VARCHAR(255)
);

CREATE TABLE playlist_music (
  id INT AUTO_INCREMENT PRIMARY KEY,
  playlist_id INT,
  music_id INT
);
```

---

### API ì˜ˆì‹œ

```python
@app.get("/music/search")
def search_music(query: str, db: Session = Depends(get_db)):
    return db.query(Music).filter(Music.title.contains(query)).all()

@app.post("/playlist/add")
def add_to_playlist(user_id: int, playlist_id: int, music_id: int, db: Session = Depends(get_db)):
    item = PlaylistMusic(playlist_id=playlist_id, music_id=music_id)
    db.add(item)
    db.commit()
    return {"message": "Added"}

@app.get("/playlist/{playlist_id}")
def get_playlist(playlist_id: int, db: Session = Depends(get_db)):
    items = db.query(PlaylistMusic).filter_by(playlist_id=playlist_id).all()
    return [
        {"title": i.music.title, "url": i.music.url}
        for i in items
    ]
```

---

## âœ… 5. Flutter í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°ì‘ ì˜ˆì‹œ

### ì¶”ê°€

```dart
await http.post(Uri.parse('http://localhost:8000/playlist/add'),
  body: jsonEncode({
    'user_id': userId,
    'playlist_id': currentPlaylistId,
    'music_id': selectedMusicId,
  }),
  headers: {'Content-Type': 'application/json'},
);
```

### ì‚­ì œ

```dart
await http.delete(Uri.parse('http://localhost:8000/playlist/remove'),
  body: jsonEncode({
    'playlist_id': currentPlaylistId,
    'music_id': musicId,
  }),
  headers: {'Content-Type': 'application/json'},
);
```

---

## ğŸ“¦ ì •ë¦¬ëœ ê¸°ëŠ¥ íë¦„

1. ğŸ” **ìŒì•… ê²€ìƒ‰**  
   `GET /music/search?query=...`

2. â–¶ï¸ **ìŒì•… ì¬ìƒ**  
   Flutterì—ì„œ `audioplayers`ë¡œ `music.url` ì¬ìƒ

3. â• **í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€**  
   `POST /playlist/add`

4. ğŸ—‘ï¸ **ì‚­ì œ**  
   `DELETE /playlist/remove`

5. ğŸ“„ **í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°**  
   `GET /playlist/{playlist_id}`

---

## ğŸ ì°¸ê³ ì‚¬í•­

- ìŒì•… íŒŒì¼ì€ **ì„œë²„ì— ì €ì¥í•˜ê±°ë‚˜ CDN, S3**ì—ì„œ í˜¸ìŠ¤íŒ… ê°€ëŠ¥
- ìŒì•… URLë§Œ ì œê³µë˜ë©´ Flutter Webì—ì„œë„ ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°ì„ ì˜ ì²˜ë¦¬í•¨
- ì˜¤í”ˆ ì†ŒìŠ¤ ìŒì•… ìƒ˜í”Œì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŒ

---

í•„ìš”í•˜ì‹œë©´ ì´ êµ¬ì¡°ë¡œ **ì „ì²´ ì½”ë“œ í…œí”Œë¦¿**, Flutter UI ìƒ˜í”Œ, ë˜ëŠ” FastAPI DB ëª¨ë¸ê¹Œì§€ ì­‰ ë§Œë“¤ì–´ë“œë¦´ ìˆ˜ ìˆì–´ìš”.  
ì§€ê¸ˆ ë°”ë¡œ ì˜ˆì œ ì½”ë“œ ì„¸íŠ¸ ë§Œë“¤ì–´ë“œë¦´ê¹Œìš”? (ì„ íƒí•˜ì‹  í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì´ë¦„ ì €ì¥ ë°©ì‹ í¬í•¨í•´ì„œ!)
