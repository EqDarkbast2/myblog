ì¢‹ìŠµë‹ˆë‹¤! ì´ì œ ìœ„ì—ì„œ ì–¸ê¸‰ëœ **HTTPS ì„¤ì •**, **í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬**, **Refresh Token ê¸°ëŠ¥**ì— ëŒ€í•´ êµ¬ì²´ì ìœ¼ë¡œ ì •ë¦¬í•´ë“œë¦´ê²Œìš”. ğŸ‘‡

---

## ğŸ” 1. HTTPS ì ìš©: **Let's Encrypt + Certbot**

### âœ… ëª©ì :
- í´ë¼ì´ì–¸íŠ¸ â†” ì„œë²„ í†µì‹ ì„ **ì•”í˜¸í™”**í•˜ì—¬ ë³´ì•ˆ í™•ë³´

---

### ğŸ”¹ ì„¤ì¹˜ (Ubuntu ê¸°ì¤€)

```bash
sudo apt update
sudo apt install nginx certbot python3-certbot-nginx
```

---

### ğŸ”¹ Nginx ì„¤ì • ì˜ˆì‹œ (`/etc/nginx/sites-available/myapp`)

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        root /var/www/frontend/build/web;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://localhost:8000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

### ğŸ”¹ HTTPS ì¸ì¦ì„œ ë°œê¸‰

```bash
sudo certbot --nginx -d yourdomain.com
```

> ì„±ê³µí•˜ë©´ Nginxê°€ ìë™ìœ¼ë¡œ HTTPS ì„¤ì •ì„ ë°˜ì˜í•©ë‹ˆë‹¤.

---

### ğŸ”¹ ìë™ ê°±ì‹  í¬ë¡  í™•ì¸

```bash
sudo systemctl status certbot.timer
```

Letâ€™s Encrypt ì¸ì¦ì„œëŠ” **90ì¼ ìœ íš¨**, certbotì´ ìë™ ê°±ì‹ í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ 2. DB ê³„ì • ë° ë¹„ë°€ë²ˆí˜¸ `.env`ë¡œ ë¶„ë¦¬

### âœ… ëª©ì :
- ì½”ë“œì— ë¹„ë°€ë²ˆí˜¸/ë¯¼ê° ì •ë³´ í•˜ë“œì½”ë”© âŒ
- ë³´ì•ˆ, ìœ ì§€ë³´ìˆ˜ì— ì¢‹ìŒ

---

### ğŸ”¹ `.env` íŒŒì¼ ì‘ì„±

```env
DB_URL=mysql+pymysql://db_user:db_pass@localhost/db_name
SECRET_KEY=my-very-secret-key
```

---

### ğŸ”¹ `.gitignore`ì— ì¶”ê°€

```bash
echo ".env" >> .gitignore
```

---

### ğŸ”¹ FastAPIì—ì„œ ë¡œë”©í•˜ê¸°

```python
# config.py
from dotenv import load_dotenv
import os

load_dotenv()  # .env íŒŒì¼ ë¡œë“œ

DB_URL = os.getenv("DB_URL")
SECRET_KEY = os.getenv("SECRET_KEY")
```

> `pip install python-dotenv` í•„ìš”

---

## ğŸ” 3. Refresh Token ê¸°ëŠ¥ (í† í° ê°±ì‹ )

### âœ… ì´ìœ :
- **Access Token**ì€ ë³´í†µ ìˆ˜ëª…ì´ ì§§ìŒ (15~30ë¶„)
- ìœ ì €ê°€ ë¡œê·¸ì¸ ìƒíƒœë¥¼ ê³„ì† ìœ ì§€í•˜ë ¤ë©´ **Refresh Token** í•„ìš”

---

### ğŸ”¹ ë™ì‘ íë¦„

1. ë¡œê·¸ì¸ ì‹œ:
   - Access Token + Refresh Token ë°œê¸‰
2. Access Token ë§Œë£Œ ì‹œ:
   - Refresh Tokenìœ¼ë¡œ ìƒˆë¡œìš´ Access Token ì¬ë°œê¸‰ ìš”ì²­
3. Refresh Tokenë„ ë§Œë£Œ ì‹œ:
   - ë‹¤ì‹œ ë¡œê·¸ì¸

---

### ğŸ”¹ ë¡œê·¸ì¸ ì‘ë‹µ ì˜ˆì‹œ

```json
{
  "access_token": "eyJhbGciOiJIUzI1...",
  "refresh_token": "eyJhbGciOiJIUzI1...",
  "token_type": "bearer"
}
```

---

### ğŸ”¹ Refresh í† í° API ì˜ˆì‹œ

```python
@app.post("/token/refresh")
def refresh_token(refresh_token: str):
    payload = auth.verify_token(refresh_token)
    if not payload:
        raise HTTPException(status_code=401, detail="Invalid refresh token")
    new_access = auth.create_access_token(data={"sub": payload["sub"]})
    return {"access_token": new_access}
```

---

### ğŸ”¹ êµ¬í˜„ ì‹œ ìœ ì˜í•  ì 
- Refresh Tokenì€ DBì— ì €ì¥í•˜ê³  **ë§Œë£Œ/ë¡œê·¸ì•„ì›ƒ ì‹œ ë¬´íš¨í™” ê°€ëŠ¥**í•˜ê²Œ í•˜ë©´ ë” ì•ˆì „
- ë³´ì•ˆ ìœ„í•´ Refresh Tokenì€ **ì¿ í‚¤ ì €ì¥** ê¶Œì¥ (XSS ë°©ì§€)

---

ì´ì œ HTTPS, ë³´ì•ˆ ì„¤ì •, í™˜ê²½ ë¶„ë¦¬, ê·¸ë¦¬ê³  í† í° ê°±ì‹ ê¹Œì§€ í™•ì‹¤íˆ ì¤€ë¹„ëœ ìƒíƒœì…ë‹ˆë‹¤.  
í•„ìš”í•˜ì‹œë©´ `.env` ì—°ë™ëœ ì „ì²´ ë°±ì—”ë“œ í…œí”Œë¦¿ì´ë‚˜ Refresh Tokenì´ í¬í•¨ëœ êµ¬ì¡°ë„ ë§Œë“¤ì–´ë“œë¦´ ìˆ˜ ìˆì–´ìš”.  
ì–´ë–¤ ìª½ë¶€í„° í™•ì¥í•´ë³¼ê¹Œìš”?
